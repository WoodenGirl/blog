# 项目

## 前端

* vue3+ts+elementui-plus
* 数据存储-pinia
* 富文本编辑器WangEditor-next

  下载代码后，运行npm i 下载所需要的包

  后端服务器与本地地址切换 /blogWeb/vite.config.ts server/proxy/api

  运行代码 npm run dev
  打包 npm run biuld-only

## 后端

* asp.net.core+furion+sqlsugar

本地服务器数据库切换 /blogApi.Web.Entity/appensettings.json

发布 dotnet publish -c Release -o ./publish

运行 dotnet blogApi.Web.Entity.dll

# 华为云

## 申请云服务器（镜像宝塔）(需三个月以上)

放行安全组，设置密码

获取宝塔账号密码：sudo cat /credentials/password.txt
https://60.204.203.117:8888
bt_user: administrator
bt_password: 1De24T4g67VE87blogApi.Web.Entity

## 申请域名

前提：需要3个月以上的服务器
华为云审核一天，工信局工作日大概五天， 公安系统备案

备案号： 赣ICP备2024049506号

## 申请桶（obs）

新增一个权限用户，获取accessKey
网址显示图片需绑定自定义域名，配置静态管理，添加index.html,error.html
修改权限为公共读，为权限用户增添对桶与对象的相关权限

## 绑定域名

不绑定自定义域名，无法显示文件，只自动下载文件

申请的域名为二级域名，如example.com
可自定义n个三级域名，如www.example.com或obs.example.com

为云服务器添加三级域名 www.example.com，在云解析服务中添加域名解析，类型A，指向服务器ip地址
为桶中添加三级域名 obs.example.com，在云解析服务中添加域名解析，类型CName，指向桶域名
为后端添加三级域名 api.example.com， 在云解析服务中添加域名解析，类型A，指向服务器ip地址

# 宝塔

## ftp（可选，上传文件）

下载pure-ftpd
新建ftp账号
云服务器放行21，39000-40000
宝塔放行39000-40000
filezilla测试连接

## 前端

将vue打包后生成的dist文件上传
php项目中添加网站，域名为服务器绑定的域名（www.example.com），目录指向dist
设置反向代理
    名称'api',目录'/api',url 'https://api.example.com'   代理后地址：'https://api.example.com/api'
    名称'images',目录'/images/',url 'https://obs.example.com' 代理后地址：'https://obs.example.com'

## 数据库

下载mysql8.0, 低版本的mysql没有utf8mb4（文本可为表情）
下载phpmyadmin，php, 二者需版本一致(都下载最新即可)

新建数据库，phpmyadmin管理，复制root密码登陆
将本地数据库导出结构与数据，PHPmyadmin一键导入

远程连接：
    修改数据库权限，指定ip或公共
    修改新生成的用户权限，给其增删改查即可
    server为服务器ip地址或其绑定的域名
    uid,pwd为新生成的用户名与密码，root不支持连接

## 后端

设置production环境的appsettings.json，配置数据库

VS支持发布ftp，个人连接成功，但无法上传（生气😠）
VS发布到本地文件夹，FileZill上传ftp

其他项目中添加网站，目录指向执行文件，设置执行命令，绑定域名（api.example.com）
